<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Applied - AI Agent</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <button id="new-chat-btn" class="new-chat-btn">
                    <i class="fas fa-plus"></i> New Chat
                </button>
            </div>

            <div class="chat-history" id="chat-history-list">
                <!-- Chat sessions will be injected here -->
                <div class="history-item active">
                    <i class="far fa-comments"></i>
                    <span>Current Session</span>
                </div>
            </div>

            <div class="sidebar-footer">
                <a href="/jobs" class="nav-link">
                    <i class="fas fa-briefcase"></i> Jobs
                </a>
                <a href="/profile" class="nav-link">
                    <i class="fas fa-user-circle"></i> Profile
                </a>
                <button id="logout-btn" class="nav-link logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
                <div class="user-info" id="user-email-display">
                    <!-- Email injected here -->
                </div>
            </div>
        </aside>

        <!-- Main Chat Area -->
        <main class="chat-interface">
            <header class="chat-header">
                <div class="model-selector">
                    <span>Resume Expert 1.0</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="mobile-menu-btn" id="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </header>

            <div class="messages-container" id="messages-container">
                <!-- Welcome Message -->
                <div class="message bot-message">
                    <div class="avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="content">
                        <p>Hello! I'm your AI Resume Expert. I can help you find jobs, analyze your resume, or apply to
                            positions.</p>
                        <p>How can I help you today?</p>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area-wrapper">
                <!-- Action Chips -->
                <div class="action-chips">
                    <button class="chip research-btn" onclick="openSearchConfigModal()"
                        style="background: linear-gradient(135deg, #4285f4, #34a853); border: none;">
                        <i class="fas fa-search"></i> Find Jobs
                    </button>
                    <button class="chip" id="attach-resume-btn">
                        <i class="fas fa-paperclip"></i> Attach Resume
                    </button>
                    <button class="chip" onclick="window.location.href='/profile'">
                        <i class="fas fa-file-alt"></i> Update Resume
                    </button>
                </div>

                <div class="input-bar">
                    <div class="file-upload-trigger" id="upload-trigger" title="Upload Resume">
                        <i class="fas fa-paperclip"></i>
                        <input type="file" id="file-upload" accept=".pdf,.docx" style="display: none;">
                    </div>
                    <textarea id="chat-input" placeholder="Message Resume Expert..." rows="1"></textarea>
                    <button id="send-btn" class="send-btn" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                <div class="footer-text">
                    Use "Researcher" to find fresh jobs. AI can make mistakes.
                </div>
            </div>
        </main>
    </div>

    <!-- Resume Selection Modal -->
    <div id="resume-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Select Resume Context</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body" id="resume-list-container">
                <p>Loading...</p>
            </div>
        </div>
    </div>

    <!-- Search Configuration Modal -->
    <div id="search-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Search Configuration</h3>
                <span class="close-modal close-search-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <label
                        style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-size: 0.9rem;">Job
                        Titles (comma separated)</label>
                    <input type="text" id="search-titles" placeholder="e.g. Python Developer, Backend Engineer"
                        style="width: 100%; padding: 10px; border-radius: 6px; background: var(--input-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div style="margin-bottom: 20px;">
                    <label
                        style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-size: 0.9rem;">Location</label>
                    <input type="text" id="search-location" placeholder="e.g. Remote, San Francisco, CA"
                        style="width: 100%; padding: 10px; border-radius: 6px; background: var(--input-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div style="margin-bottom: 20px;">
                    <label
                        style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-size: 0.9rem;">Max
                        Results</label>
                    <input type="number" id="search-limit" value="10" min="1" max="20"
                        style="width: 100%; padding: 10px; border-radius: 6px; background: var(--input-bg); color: var(--text-primary); border: 1px solid var(--border-color);">
                </div>
                <div style="margin-bottom: 20px;">
                    <label
                        style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-size: 0.9rem;">Resume
                        Context</label>
                    <select id="search-resume-select"
                        style="width: 100%; padding: 10px; border-radius: 6px; background: var(--input-bg); color: var(--text-primary); border: 1px solid var(--border-color);"></select>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button id="confirm-search-btn"
                        style="width: 100%; padding: 12px; background: var(--accent-color); color: #000; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1rem;">
                        <i class="fas fa-search"></i> Start Search
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Job Card Template (Hidden) -->
    <template id="job-card-template">
        <div class="job-card">
            <div class="job-header">
                <h3 class="job-title"></h3>
                <span class="match-score"></span>
            </div>
            <div class="job-company"></div>
            <div class="job-actions">
                <a href="#" target="_blank" class="view-btn">View</a>
                <button class="apply-btn">Apply</button>
            </div>
            <div class="status-badge"></div>
        </div>
    </template>

    <script src="/static/script.js"></script>
</body>

</html>